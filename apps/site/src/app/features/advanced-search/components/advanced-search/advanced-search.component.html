<div class="container">
  <h5>
    Расширенный поиск
    <small
      ><a [routerLink]="['/books']" class="underline">поиск по имени</a></small
    >
  </h5>

  <form [formGroup]="form" (submit)="submit()">
    <section class="parameter-grid">
      <span>Рейтинг не ниже чем:</span>
      <input
        matInput
        min="0"
        max="10"
        step="0.5"
        type="number"
        placeholder="От 0 до 10"
        formControlName="rating"
        [value]="form.value.rating"
      />
      <lib-star-rating
        formControlName="rating"
        [rating]="form.value.rating"
        [showLabel]="false"
      ></lib-star-rating>
      <button mat-fab extended="true" color="success" type="submit">
        <mat-icon>search</mat-icon>
        Искать
      </button>
    </section>

    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>Жанры</mat-panel-title>
        <mat-panel-description>
          @for (genre of getFormParams().genres; track genre) {
          <mat-chip (click)="unselectGenre($event, genre)"
            >{{ FB2_GENRES[genre] }} ✕</mat-chip
          >
          }
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="content">
        @for (genreKey of FB2_GENRE_UNIQUE_KEYS; track genreKey) {
        <label>
          <input type="checkbox" [formControlName]="genreKey" />
          <span>{{ FB2_GENRES[genreKey] }}</span>
        </label>
        }
      </div>
    </mat-expansion-panel>

    <div class="action-panel">
      <button mat-fab extended="true" color="success" type="submit">
        <mat-icon>search</mat-icon>
        Искать
      </button>
    </div>
  </form>
  <p>&nbsp;</p>
  <h5 #searchResult>Результаты поиска</h5>
  <div class="search-result">
    @if (data()) { @if (data()!.length === 0) {
    <span>По вашему запросы книги не найдены</span>
    }
    <div class="grid books-grid">
      @for (item of data(); track item.id){
      <nav>
        <lib-tag-link [value]="item.id" linkPrefix="/book">
          {{ item.full }}
        </lib-tag-link>
      </nav>
      }
    </div>
    }
  </div>
  @if (error()) {
  <span>Ошибка: {{ error() | json }}</span>
  }
</div>
